

# $\color{pink}{||图解HTTP协议||}$

23040905 王欣儿 网络组后端

（笔记全是文字，因为截图锁定c盘地址所以无法显示在md文件里，图片被单独显示

大多图片都是《图解HTTP协议》的插图。）

---

---

## 第 1 章  了解Web及网络基础

> <b>1.1</b>
> 
> 输入URL，是客户端的信息被送往某处，然后得到回复，内容显示在Web页面上
> 
> 内容不是凭空的
> 
> 内容是web浏览器从web服务器端获取的文件资源，再显示页面。
> 
> > 客户端—>服务器   用地址获取或者是上传服务器信息
> > 
> > 服务器—>客户端   使用HTTP协议的通信 
> 
> > > Web 使用一种名为 HTTP（HyperText Transfer Protocol，超文本传输协议 ）的协议作为规范，完成从客户端到服务器端等一系列运作流程。而协议是指规则的约定。可以说，Web 是建立在 HTTP 协议上通信的。

---

> 1.2
> 
> 最初设想的基本理念是：借助<mark>多文档之间相互关联形成的超文本</mark>（HyperText），连成<u>可相互参阅的 WWW（World Wide Web，万维网</u>）。 方便研究者共享知识
> 
> 现在已提出了 3 项 WWW 构建技术，分别是：
> 
> 把 <mark>SGML</mark>（Standard Generalized Markup Language，标准通用标记语言）作为页面的文本标记语言的 <mark>HTML</mark>（HyperText Markup Language，超文本标记语言）；
> 
> 作为文档传递协议的 <mark>HTTP</mark> ；
> 
> 指定文档所在地址的<mark> URL</mark>（Uniform Resource Locator，统一资源定位符）。
> 
> <mark>WWW </mark>这一名称，是 Web 浏览器当年用来浏览超文本的客户端应用
> 程序时的名称。现在则用来表示这一系列的集合，也可简称为 Web。
> 
> > 从 1995 年左右起，微软公司与网景通信公司之间爆发的浏览器大战愈演愈烈。两家公司都各自对 HTML做了扩展，于是导致在写 HTML页面时，必须考虑兼容他们两家公司的浏览器。时至今日，这个问题仍令那些写前端页面的工程师感到棘手。
> 
> > 在这场浏览器供应商之间的竞争中，他们不仅对当时发展中的各种Web 标准化视而不见，还屡次出现新增功能没有对应说明文档的情况。
> > 2000 年前后，这场浏览器战争随着网景通信公司的衰落而暂告一段落。但就在 2004 年，Mozilla 基金会发布了 Firefox 浏览器，第二次浏览器大战随即爆发。
> > Internet Explorer 浏览器的版本从 6 升到 7 前后花费了 5 年时间。之后接连不断地发布了 8、9、10 版本。另外，Chrome、Opera、Safari 等浏览器也纷纷抢占市场份额。
> 
> HTTP 于 1990 年问世。
> 
> HTTP 正式作为标准被公布是在 1996 年的 5 月，版本被命名为HTTP/1.0，并记载于 RFC1945。虽说是初期标准，但该协议标准至今
> 仍被广泛使用在服务器端。
> 
> 1997 年 1 月公布的<mark> HTTP/1.1</mark> 是目前主流的 HTTP 协议版本。当初的
> 标准是 RFC2068，之后发布的<mark>修订版 RFC2616 就是当前最新版本</mark>。

---

> 1.3
> 
> <mark>通常使用的网络（包括互联网）是在 TCP/IP 协议族的基础上运作的。而 HTTP 属于它内部的一个子集。</mark>
> 
> 计算机与网络设备要相互通信，双方就必须基于相同的方法。而我们就把这种规则称为协议（protocol）。
> 
> 协议中存在各式各样的内容。从电缆的规格到 IP 地址的选定方法、寻找异地用户的方法、双方建立通信的顺序，以及 Web 页面显示需要处理的步骤，等等。
> <mark>像这样把与互联网相关联的协议集合起来总称为 TCP/IP。</mark>
> 
> TCP/IP 协议族里重要的一点就是分层。TCP/IP 协议族按层次分别分
> 为以下 4 层<mark>：应用层、传输层、网络层和数据链路层。</mark>
> 
> 层次化的优点：方便替换某层，设计简单不需要考虑其他层。
> 
> ## 应用层
> 
> 决定向用户提供应用服务时通信的活动。预存各类通用的应用服务。FTP（FileTransfer Protocol，文件传输协议）和 DNS（Domain Name System，域名系统）服务就是其中两类。
> 
> <mark>HTTP</mark>也位于这层。
> 
> ## 传输层
> 
> 用于传输两台计算机间得到数据。
> 
> 在传输层有两个性质不同的协议：<mark>TCP</mark>和UDP（用户数据报协议）
> 
> ## 网络层
> 
> 用来处理网络上流动的数据包。
> 
> > 数据包是网络传输的最小数据单位
> 
> 该层规定了通过什么路径到达对方计算机，传输数据包。
> 
> 如果是多台设备间传输，那么网络层的作用就是在众多的选项内选择一条传输路线。
> 
> ## 链路层（数据链路层、网络接口层）
> 
> 用来处理连接了网络的硬件。
> 
> 包括控制操作系统、硬件的设备驱动、NIC（Network Interface Card，网络适配器，即网卡），及光纤等物理可见部分（还包括连接器等一切传输媒介）。硬件上的范畴均在链路层的作用范围之内。
> 
> > 真正传输起来：
> > 
> > 利用 TCP/IP 协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端则往应用层往上走。
> > 
> > 我们用 HTTP 举例来说明，首先作为发送端的客户端在应用层（HTTP 协议）发出一个想<u>看某个 Web 页面的 HTTP 请求</u>。
> > 接着，为了传输方便，在传输层（TCP 协议）把从应用层处收到的数据（HTTP 请求报文）进行<u>分割</u>，并在各个报文上打上标记序号及端口号后转发给网络层。
> > 在网络层（<mark>IP 协议</mark>），增加作为<u>通信目的地</u>的 MAC 地址后转发给链路层。这样一来，发往网络的通信请求就准备齐全了。
> > 接收端的服务器在链路层接收到数据，按序往上层发送，一直到应用层。当传输到应用层，才能算真正接收到由客户端发送过来的 HTTP请求。
> 
> 发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层时会把对应的首部消去。
> 
> 封上又打开？
> 这种把数据信息包装起来的做法称为封装（encapsulate）。

---

> 1.4     与 HTTP 关系密切的协议 : IP、TCP 和DNS
> 
> ## IP协议（负责传输）
> 
> 按层次划分，属于<mark>网络层</mark>。
> 
> TCP/IP协议族里的<mark>IP是网际协议</mark>，不要跟IP地址搞混
> 
> IP 协议的作用是把各种数据包传送给对方。
> 
> > 而要保证确实传送到对方那需要满足各类条件。其中两个重要的条件是 IP 地址和 MAC地址（Media Access Control Address）。
> > 
> > IP 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定地址。
> > 
> > IP 地址可以和 MAC 地址进行<u>配对</u>。
> > 
> > <mark>IP 地址可变换，但 MAC地址基本上不会更改</mark>。
> > 
> > **使用 ARP 协议凭借 MAC 地址进行通信**
> > 
> > 通信双方大概率不在局域网里，所以需要多次中转。而中转需要MAC地址搜索目标，这时候用ARP协议，用以解析地址，根据通信方的IP地址反查出对应MAC地址。
> 
> 在到达通信目标前的中转过程中，那些计算机和路由器等网络设备只能获悉很粗略的传输路线。
> 
> ## TCP协议（确保靠谱）
> 
> 按层次分，TCP 位于<mark>传输层</mark>，提供可靠的字节流服务。
> 
> > 所谓的字节流服务（Byte Stream Service）是指，为了方便传输，将块数据分割成以报文段（segment）为单位的数据包进行管理。而可靠的传输服务是指，能够把数据准确可靠地传给对方。一言以蔽之，TCP 协议为了更容易传送大数据才把数据分割，而且 TCP 协议能够确认数据最终是否送达到对方。
> 
> 为了准确无误地将数据送达目标处，TCP 协议采用了<mark>三次握手</mark>（three-way handshaking）策略。用 TCP 协议把数据包送出去后，TCP不会对传送后的情况置之不理，它一定会向对方确认是否成功送达。
> 
> 握手过程中使用了 TCP 的标志（flag） —— SYN（synchronize） 和
> ACK（acknowledgement）。
> 
> > 发送端首先发送一个带 SYN 标志的数据包给对方。接收端收到后，
> > 回传一个带有 SYN/ACK 标志的数据包以示传达确认信息。最后，发
> > 送端再回传一个带 ACK 标志的数据包，代表“握手”结束。
> > 
> > 若突然中断，会再次相同发送

---

> 1.5
> 
> ## DNS服务（负责域名解析）
> 
> 和HTTP一样位于<mark>应用层</mark>。
> 
> 提供域名到IP地址的解析服务。
> 
> > 计算机既可以被赋予IP地址，也可以被赋予主机名和域名。
> > 
> > 比如：www.hackr.jp。
> 
> 用户通常使用主机名或域名来访问对方计算机，而不是IP地址。符合人类记忆习惯。
> 
> 为了方便计算机理解这些名称，DNS服务诞生。
> 
> 这个服务通过提供域名查找IP地址，向那个IP地址的服务器发送访问请求。见配图。
> 
> > 比如解析baidu的域名得到那个要实际访问百度的的IP地址。

---

> 1.6
> 
> ## 各种协议与HTTP协议的关系（文字梳理）
> 
> 说白了，我们要浏览某个页面，先把域名由DNS服务解析得到对方服务器的IP地址。
> 
> 然后，HTTP协议针对目标服务器生成HTTP请求报文。
> 
> 再然后，TCP协议确保可靠，将HTTP请求报文分成多个段，然后把每一个都可靠传到对方。
> 
> 在之中，网络层的IP协议搜索对方地址，一边中转一边传送，途径多台设备。
> 
> <u>到对面</u>
> 
> 对面的TCP协议负责接收各个报文段，然后重组原来的顺序得到请求报文。
> 
> 对面的HTTP协议负责对这个请求内容的处理。
> 
> 处理结果同样利用TCP/IP协议向用户进行回传。

---

> 1.7
> 
> ## URI和URL
> 
> 其中<mark>URL</mark>（Uniform Resource Locator，统一资源定位符）常见为访问Web页面的网页地址，如baidu.com。
> 
> ---
> 
> <mark>URI</mark>是统一资源标识符。
> 
> URI 是 Uniform Resource Identifier 的缩写。
> 
> uniform规定统一格式方便处理多种不同类型的资源。
> 
> resource就是资源。
> 
> identifier表示可标识的对象，也称为标识符。
> 
> 所以URI 就是由某个协议方案表示的<mark>资源的定位标识符</mark>。（协议方案是指访问资源所使用的协议类型名称。）
> 
> 采用 HTTP 协议时，协议方案就是 http。除此之外，还有 ftp、mailto、telnet、file 等。<u>标准的 URI 协议方案有 30 种左右。</u>
> 
> > URI 用字符串标识某一互联网资源，而 URL表示资源的地点（互联
> > 网上所处的位置）。可见 URL是 URI 的子集。
> > 
> > 如几种URI例子：
> > 
> > ftp://ftp.is.co.za/rfc/rfc1808.txt
> > http://www.ietf.org/rfc/rfc2396.txt
> > ldap://[2001:db8::7]/c=GB?objectClass?one
> > mailto:John.Doe@example.com
> > news:comp.infosystems.www.servers.unix
> 
> > <u>格式上</u>
> > 
> > 表示指定的 URI，要使用涵盖全部必要信息的绝对 URI、绝对 URL以及相对 URL。相对 URL，是指从浏览器中基本 URI 处指定的 URL，形如 /image/logo.gif。
> > 
> > > <mark>绝对URI格式</mark>：
> > > 
> > > <mark>协议方案名（如http）、登录信息（认证）、服务器地址、冒号加服务器端口号、带层次的文件路径、查询字符串、片段标识符</mark>
> > > 
> > > <u>1.使用 http: 或 https: 等协议方案名获取访问资源时要指定协议类型。**不区分字母大小写**，**最后附一个冒号**（:）。</u>
> > > 
> > > 2.也可使用 data: 或 javascript: 这类指定数据或脚本程序的方案名。
> > > 
> > > 3.指定用户名和密码作为从服务器端获取资源时必要的登录信息（身份认证）。此项是可选项。
> > > 
> > > 4.使用绝对 URI **必须指定**待访问的服务器地址。
> > > 
> > > （可以是类似hackr.jp 这种 DNS 可解析的名称，或是 192.168.1.1 这类 IPv4 地址名，还可以是 [0:0:0:0:0:0:0:1] 这样用方括号括起来的 IPv6 地名。）
> > > 
> > > 5.服务器端口号<u>可以省略</u>，则自动使用默认端口号。
> > > 
> > > 6.带层次的文件路径，实际制定了服务器上的文件路径来定位资源。
> > > 
> > > 7.查询字符串，用于对特定资源传入任意参数来查询，是<u>可选项</u>。
> > > 
> > > 8.片段标识符，也是<u>可选项</u>，通常标记已获取资源中的子资源。（文档中某个位置）
> > 
> > 并不是所有的应用程序都符合<mark> RFC</mark>
> > 有一些用来制定 HTTP 协议技术标准的文档，它们被称为RFC（Request for Comments，征求修正意见书）。
> > 
> > 实际在互联网上，已经实现了 HTTP 协议的一些服务器端和客户端里就存在上述情况。说不定它们会与本书介绍的 HTTP 协议的实现情况不一样。
> > 本书接下来要介绍的 HTTP 协议内容，除去部分例外，基本上都以RFC 的标准为准。



---

---

## 第二章 简单的HTTP协议


> 2.1
> 
> ### HTTP协议用于客户端和服务器端之间的通信
> 
> 应用 HTTP 协议时，必定是一端担任客户端角色，另一端担任服务器端角色。
> 
> 有时候，按实际情况，两台计算机作为客户端和服务器端的角色有可能会互换。但就仅从一条通信路线来说，服务器端和客户端的角色是确定的，而用 HTTP 协议能够明确区分哪端是客户端，哪端是服务器端。

---

> 2.2
> 
> ### 通过请求和响应的交换达成通信
> 
> 请求必定由客户端发出，而服务器端回复响应。
> 
> HTTP 协议规定，请求从客户端发出，最后服务器端响应该请求并返回。
> 
> 换句话说，肯定是先从客户端开始建立通信的，服务器端在没有接收到请求之前不会发送响应。     
> 
> #### 发送请求
> 
> > 举例
> > 
> > ```
> > GET /index.htm HTTP/1.1
> > Host: hackr.jp
> > ```
> > 
> > 起始行开头的GET表示请求访问服务器的类型，还有POST，称为方法（method）。
> > 
> > 随后的字符串 /index.htm 指明了请求访问的资源对象，也叫做请求 URI（request-URI）。
> > 
> > 最后的 HTTP/1.1，即 HTTP 的版本号，用来提示客户端使用的 HTTP 协议功能。
> > 
> > 综合意思是：请求访问某台 HTTP 服务器上的/index.htm 页面资源。
> 
> <mark>请求报文是由请求方法、请求 URI、协议版本、可选的请求首部字段和内容实体构成的。</mark>例子见配图。
> 
> 其中URI感觉是绝对URI的文件路径，请求首部字段可以有很多内容（host，connection，length等）
> 
> #### 发送响应
> 
> > 举例
> > 
> > ```
> > HTTP/1.1 200 OK
> > Date: Tue, 10 Jul 2012 06:50:15 GMT
> > Content-Length: 362
> > Content-Type: text/html
> > <html>
> > ……
> > ```
> > 
> > 第一个是服务器对应的http版本。
> > 
> > 200 OK表示请求的处理结果的状态码（status code）和原因短语（reason-phrase）。
> > 
> > ——这里200是状态码，OK是状态码的原因短语。
> > 
> > 下一行显示了创建响应的日期时间，再下一行是首部字段（header field）内的一个属性。
> > 
> > 接着以一空行分隔，之后的内容称为资源实体的主体（entity body）。
> 
> <mark>响应报文基本上由协议版本、状态码（表示请求成功或失败的数字代码）、用以解释状态码的原因短语、可选的响应首部字段以及实体主体构成。</mark>

---

> 2.3
> 
> ### HTTP 是不保存状态的协议
> 
>  HTTP 是一种不保存状态，即无状态（stateless）协议。HTTP 协议自身不对请求和响应之间的通信状态进行保存。
> 
> （说白了就算是发送了请求就忘了，而对面服务器也是，忘记自己发给你什么了）
> 
> 永远是：新请求对应新响应
> 
> 不保留之前一切的请求和响应报文，方便处理大量事务，确保可伸缩性。
> 
> 现在为了实现记录登陆状态等保持状态功能，引入了<mark>Cookie</mark>技术，有了这个再用HTTP协议通信，就可以管理状态了。

---

> 2.4
> 
> ### 请求URI定位资源
> 
> 运用URI，可以让互联网上任意位置资源都访问到。
> 
> 当客户端请求访问资源而发送请求时，URI 需要将作为请求报文中的请求 URI 包含在内。指定请求 URI 的方式有很多。
